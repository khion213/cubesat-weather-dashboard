<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CubeSat City Telemetry Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <style>
    body {
      background: #050816;
      color: #f8f9fa;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .navbar {
      background: linear-gradient(90deg, #0d6efd, #6610f2);
    }

    .card {
      background: #111827;
      border: 1px solid #1f2937;
      border-radius: 1rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
    }

    .card-title {
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .sensor-value {
      font-size: 1.6rem;
      font-weight: 700;
    }

    .unit {
      font-size: 0.9rem;
      opacity: 1;
      color: #ffffff !important;
    }

    .badge-sat {
      background: linear-gradient(90deg, #0d6efd, #20c997);
      border: none;
    }
 


    .status-text {
      font-size: 0.9rem;
      opacity: 1;
      color: #ffffff !important;
    }

    .error-text {
      color: #ff6b6b !important;
    }

    .card * {
      color: #ffffff !important;
    }

   
    #suggestions {
      max-height: 200px;
      overflow-y: auto;
      border-radius: 0.5rem;
    }

    #suggestions .list-group-item {
      cursor: pointer;
      background-color: #0b1220;
      border-color: #1f2937;
    }

    #suggestions .list-group-item:hover {
      background-color: #1f2937;
    }
#cityInput {
  color: black !important;
}

  </style>
</head>
<body>

  
  <nav class="navbar navbar-dark mb-4">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">
        üõ∞Ô∏è CubeSat City Telemetry
      </span>
      <span class="badge badge-sat rounded-pill px-3 py-2">
        Live Weather
      </span>
    </div>
  </nav>

  <div class="container mb-5">

 
    <div class="row mb-4">
      <div class="col-lg-8 mx-auto">
        <div class="card p-3">
          <h5 class="card-title mb-3">Select any city in the world</h5>
          <div class="input-group mb-2">
            <input
              type="text"
              id="cityInput"
              class="form-control"
              placeholder="Example: Baghdad, London, Tokyo"
              autocomplete="off"
            />
            <button class="btn btn-primary" id="searchBtn">Get Data</button>
          </div>

          
          <div id="suggestions" class="list-group mb-2" style="display: none;"></div>

          <div class="status-text" id="statusText">
            Enter a city name and click "Get Data".
          </div>
        </div>
      </div>
    </div>

   
    <div class="row mb-4">
      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h6 class="text-secondary text-uppercase mb-2">Location</h6>
          <p class="mb-1"><strong>City:</strong> <span id="cityName">---</span></p>
          <p class="mb-1"><strong>Country:</strong> <span id="country">---</span></p>
          <p class="mb-0"><strong>Coords:</strong>
            <span id="coords">-- , --</span>
          </p>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h6 class="text-secondary text-uppercase mb-2">Environment</h6>
          <p class="mb-1"><strong>Altitude (estimated):</strong>
            <span id="altitude" class="sensor-value">---</span>
            <span class="unit">m</span>
          </p>
          <p class="mb-1"><strong>Pressure:</strong>
            <span id="pressure" class="sensor-value">---</span>
            <span class="unit">hPa</span>
          </p>
          <p class="mb-0"><strong>Local Time:</strong>
            <span id="timeNow">--:--:--</span>
          </p>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h6 class="text-secondary text-uppercase mb-2">Power System (Estimated)</h6>
          <p class="mb-1"><strong>Voltage:</strong>
            <span id="voltage" class="sensor-value">---</span>
            <span class="unit">V</span>
          </p>
          <p class="mb-0"><strong>Current:</strong>
            <span id="current" class="sensor-value">---</span>
            <span class="unit">A</span>
          </p>
        </div>
      </div>
    </div>

    <!-- Real Weather Sensors -->
    <h4 class="mb-3">Environmental Sensors (Real Weather)</h4>
    <div class="row">
      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h5 class="card-title">Temperature</h5>
          <p class="sensor-value mb-0">
            <span id="temperature">--</span>
            <span class="unit">¬∞C</span>
          </p>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h5 class="card-title">Humidity</h5>
          <p class="sensor-value mb-0">
            <span id="humidity">--</span>
            <span class="unit">%</span>
          </p>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h5 class="card-title">Solar Radiation (Estimated)</h5>
          <p class="sensor-value mb-0">
            <span id="solarRadiation">--</span>
            <span class="unit">W/m¬≤</span>
          </p>
        </div>
      </div>
    </div>

    <!-- Simulated 3-Axis -->
    <h4 class="mt-4 mb-3">Attitude Control (3-Axis ‚Äì Simulated)</h4>
    <div class="row">
      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h5 class="card-title">Roll</h5>
          <p class="sensor-value mb-0">
            <span id="roll">--</span>
            <span class="unit">deg</span>
          </p>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h5 class="card-title">Pitch</h5>
          <p class="sensor-value mb-0">
            <span id="pitch">--</span>
            <span class="unit">deg</span>
          </p>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card p-3 h-100">
          <h5 class="card-title">Yaw</h5>
          <p class="sensor-value mb-0">
            <span id="yaw">--</span>
            <span class="unit">deg</span>
          </p>
        </div>
      </div>
    </div>

    <div class="text-center mt-4 status-text">
      CubeSat Telemetry Interface ‚Äì Real City Weather + Simulated Satellite Sensors - From Ali
    </div>
  </div>

  <script>
    const API_KEY = "Your API-KEY";

    function randomInRange(min, max, decimals = 1) {
      return (Math.random() * (max - min) + min).toFixed(decimals);
    }

    function setStatus(msg, isError = false) {
      const el = document.getElementById("statusText");
      el.textContent = msg;
      if (isError) el.classList.add("error-text");
      else el.classList.remove("error-text");
    }

    function updateTime() {
      document.getElementById("timeNow").textContent = new Date().toLocaleTimeString();
    }

    function estimateAltitudeFromPressure(P) {
      return 44330 * (1 - Math.pow(P / 1013.25, 1 / 5.255));
    }

    function updateUI(data) {
      const city = data.name;
      const country = data.sys.country;
      const temp = data.main.temp;
      const humidity = data.main.humidity;
      const pressure = data.main.pressure;
      const clouds = data.clouds ? data.clouds.all : 0;

      const lat = data.coord.lat;
      const lon = data.coord.lon;

      document.getElementById("cityName").textContent = city;
      document.getElementById("country").textContent = country;
      document.getElementById("coords").textContent = lat.toFixed(2) + ", " + lon.toFixed(2);

      document.getElementById("temperature").textContent = temp.toFixed(1);
      document.getElementById("humidity").textContent = humidity;
      document.getElementById("pressure").textContent = pressure;

      const altitude = estimateAltitudeFromPressure(pressure);
      document.getElementById("altitude").textContent = altitude.toFixed(0);

      let solar = (1 - clouds / 100) * 1000;
      if (solar < 0) solar = 0;
      document.getElementById("solarRadiation").textContent = solar.toFixed(0);

      const voltage = 5 + (solar / 1000) * 3;
      const current = 0.3 + (solar / 1000) * 2;
      document.getElementById("voltage").textContent = voltage.toFixed(2);
      document.getElementById("current").textContent = current.toFixed(2);

      document.getElementById("roll").textContent = randomInRange(-180, 180);
      document.getElementById("pitch").textContent = randomInRange(-90, 90);
      document.getElementById("yaw").textContent = randomInRange(-180, 180);

      updateTime();
      setStatus("Updated telemetry for: " + city + " ‚úÖ");
    }

    async function fetchCityWeather(city) {
      if (!API_KEY) {
        setStatus("Please provide a valid API key.", true);
        return;
      }

      if (!city || city.trim() === "") {
        setStatus("Please enter a city name.", true);
        return;
      }

      setStatus("Fetching data from OpenWeather API...");

      const url =
        "https://api.openweathermap.org/data/2.5/weather?q=" +
        encodeURIComponent(city) +
        "&units=metric&appid=" +
        API_KEY;

      try {
        const res = await fetch(url);
        if (!res.ok) {
          if (res.status === 404) {
            throw new Error("City not found. Check spelling.");
          } else {
            throw new Error("API Error. Code: " + res.status);
          }
        }

        const data = await res.json();
        updateUI(data);
      } catch (err) {
        console.error(err);
        setStatus(err.message, true);
      }
    }

    let suggestTimeout = null;

    async function fetchCitySuggestions(query) {
      const suggestionsBox = document.getElementById("suggestions");

      if (!query || query.trim().length < 2) {
        suggestionsBox.style.display = "none";
        suggestionsBox.innerHTML = "";
        return;
      }

      const url =
        "https://api.openweathermap.org/geo/1.0/direct?q=" +
        encodeURIComponent(query) +
        "&limit=5&appid=" +
        API_KEY;

      try {
        const res = await fetch(url);
        const list = await res.json();

        suggestionsBox.innerHTML = "";

        if (!Array.isArray(list) || list.length === 0) {
          suggestionsBox.style.display = "none";
          return;
        }

        list.forEach((item) => {
          const name = item.name;
          const country = item.country || "";
          const state = item.state ? ", " + item.state : "";

          const el = document.createElement("button");
          el.type = "button";
          el.className = "list-group-item list-group-item-action";
          el.textContent = name + state + " (" + country + ")";
          el.addEventListener("click", () => {
            const cityInput = document.getElementById("cityInput");
            cityInput.value = name + (country ? "," + country : "");
            suggestionsBox.style.display = "none";
            suggestionsBox.innerHTML = "";
            fetchCityWeather(cityInput.value);
          });

          suggestionsBox.appendChild(el);
        });

        suggestionsBox.style.display = "block";
      } catch (err) {
        console.error("Suggestions error:", err);
      }
    }

    document.getElementById("cityInput").addEventListener("input", (e) => {
      const val = e.target.value;

      if (suggestTimeout) clearTimeout(suggestTimeout);
      suggestTimeout = setTimeout(() => {
        fetchCitySuggestions(val);
      }, 400); // small debounce
    });

    document.getElementById("searchBtn").addEventListener("click", () => {
      const city = document.getElementById("cityInput").value;
      document.getElementById("suggestions").style.display = "none";
      document.getElementById("suggestions").innerHTML = "";
      fetchCityWeather(city);
    });

    document.getElementById("cityInput").addEventListener("keyup", (e) => {
      if (e.key === "Enter") {
        const city = document.getElementById("cityInput").value;
        document.getElementById("suggestions").style.display = "none";
        document.getElementById("suggestions").innerHTML = "";
        fetchCityWeather(city);
      }
    });

    setInterval(updateTime, 1000);
    updateTime();
  </script>

</body>
</html>
